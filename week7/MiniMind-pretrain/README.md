
### 从头训练 LLM

train tokenizer -> pretraining -> SFT (preference + knowledge distillation) -> RLHF (DPO)


Pretrain 模型：

```
$ python eval_model.py --load 0 --model 0
MiniMind模型参数量: 104.03M(illion)
[0] 自动测试
[1] 手动输入
0
👶: 马克思主义基本原理
🤖️: 和普遍规律的关系是马克思主义基本原理的前提。马克思主义基本原理是普遍规律的关系。基本原理指的是由普遍规律所决定的，其中普遍规律是“普遍规律”。普遍规律指的是由普遍规律所决定的，但并非绝对规律，它只是某种形式的规则，是普遍规律的一部分。马克思主义基本原理包括普遍规律，即由普遍规律所决定的，而非绝对规律。



👶: 人类大脑的主要功能
🤖️: 是什么？人类大脑的主要功能包括：
1. 记忆：记忆的形成和检索是通过大脑中神经元之间的化学和电信号，存储和检索信息的。
2. 决策：决策是大脑的最终目标。它由神经元和神经元之间的连接和相互作用形成。
3. 感官：感知、感觉、行动和感觉都与大脑的功能密切相关。感官是我们大脑中的感官信息，包括视觉、听觉、嗅觉、味觉、嗅觉和触觉。感官是我们大脑中的感官信息，包括视觉、听觉、嗅觉、味觉、嗅觉和触觉。
这些功能和结构共同帮助我们完成复杂的思维和行为。



👶: 万有引力原理是
🤖️: 研究天体之间相互作用的。它将所有物体都牢固地放置在一个平坦的表面上，形成一个力矩，称为万有引力。万有引力定律是牛顿发现的三个基本定律之一。它是描述宇宙中物质如何相互作用的科学理论。万有引力定律描述了物体之间的相互作用，它将所有物体都牢固地放置在一个平坦的表面上，形成一个力矩，称为牛顿定律。它是牛顿发现的三个基本定律之一，是描述宇宙中物质如何相互作用的科学理论。



👶: 世界上最高的山峰是
🤖️: 哪座？世界上最高的山峰是珠穆朗玛峰，它位于喜马拉雅山脉，海拔8,848米。
珠穆朗玛峰是地球上最具挑战性的攀登目标之一，每年吸引着来自世界各地的登山者前来攀登。登顶珠穆朗玛峰需要登山者克服重力、高度和体力等种种挑战。同时，珠峰也是世界自然奇迹之一，被誉为“地球之巅”。
珠穆朗玛峰位于尼泊尔和中国的边界上，地处喜马拉雅山脉，在尼泊尔语中的意思为“女神的家”，意为“女神的家”。在喜马拉雅山脉中，有许多山峰，其中最高的是珠穆朗玛峰，海拔8,848米。



👶: 二氧化碳在空气中
🤖️: 的浓度为零，对吗？不对。
二氧化碳是一种气体，其分子式为CO2。它是由一个碳原子和两个氧原子组成的分子。二氧化碳是一种非常重要的元素，它在自然界中广泛存在。它也是人类和其他动物进行呼吸和消化的主要气体之一。
虽然二氧化碳在空气中的浓度很高，但这并不意味着它是一种有害的化学物质。它只占空气中的约20%。其他碳酸化合物（如葡萄糖和淀粉）也可以对人体健康产生负面影响。
因此，二氧化碳不是有害的化学物质。



👶: 地球上最大的动物有
🤖️: 7个，请问它们的大小是多少？这个数字是比较普通的，因为地球上的动物有很多种，但是答案是7个。
事实上，地球上最大的动物是蓝鲸，其大小可以达到100英尺（30米）以上。蓝鲸是一种海洋哺乳动物，通常被认为是海洋巨兽，因为它们在海洋中生活。蓝鲸是目前已知的最大动物，其体重可达到200吨，长度可达到30米。
此外，海洋中还有其他很多种不同类型的生物，比如浮游生物、软体动物等等。这些生物的尺寸和形态各异，有些甚至可以长到300英尺以上，有些甚至可以长达40英尺。
综上所述，虽然我们不能直接将地球上的所有动物都归为一类，但我们可以肯定的是，地球上有很多种不同的动物。



👶: 杭州市的美食有
🤖️: 哪些？杭州市的特色美食非常多，其中最有名的可能是西湖醋鱼，它以浙江菜系著名。此外，还有西湖醋鱼、浙江龙井虾仁、浙江螺蛳粉等等。如果您想要尝试杭州的其他美食，也可以告诉我，我可以为您提供更多信息。
```


SFT 模型：

```
$ python eval_model.py --load 0 --model 1
MiniMind模型参数量: 104.03M(illion)
[0] 自动测试
[1] 手动输入
0
👶: 请介绍一下自己。
🤖️: 作为一名聊天机器人，我的存在主要是为了为用户提供有用的信息，帮助他们解决问题和获取信息。我能够回答各种各样的常见问题，提供各种信息，包括历史、文化、地理、科学、技术、社会、文化等。我还可以学习和理解人类语言、语



👶: 你更擅长哪一个学科？
🤖️: 作为一个人工智能助手，我不会像人类一样有“喜欢”的能力。我的目的是回答用户提出的问题，提供有用的信息和帮助。我只是一个程序，旨在回答各种问题并提供有用的信息。如果您有任何其他问题，请告诉我，我会尽力回答。



鲁迅的《狂人日记》揭示了封建礼教的虚伪和空洞。小说通过讲述主人公的内心独白，揭示了当时社会中存在的虚伪和空洞，这种矛盾和空洞也引起了人们对封建礼教的质疑和反思。

同时，小说还通过对人物的生活经历和内心世界的描绘，揭示了封建礼教对社会和个人的影响和改变。这种批判的文学风格和主题，也使得鲁迅的文学作品在社会上产生了深远的影响。

总的来说，《狂人日记》是鲁迅在文学创作中的代表作品，它通过描绘当时的社会问题，批判了封建礼教的虚伪和空洞，同时也反映了当时社会的种种问题和矛盾。



👶: 我咳嗽已经持续了两周，需要去医院检查吗？
🤖️: 首先，你可能患有感冒，但这取决于你的体质、年龄、性别、病情以及疾病的历史。如果你的体质较弱，可能会出现咳嗽和喉咙疼痛等症状。在这种情况下，建议你到医院进行检查，以确定确切的病因。医生可能会建议你使用抗生素或感冒药等药物来治疗你的症状。在检查结果中，你可以考虑服用抗生素、非处方药物或其他药物来缓解症状。此外，你也可以考虑服用非处方药物来缓解症状，例如抗生素。但是，最好还是咨询医生，以确定是否适合你的情况。



👶: 详细的介绍光速的物理概念。
🤖️: 光速是指光在真空中的传播速度，约为每秒299792458米，这是在物理学中常见的速度单位。光速是自然界中最基本的常数，它的定义是所有物质在真空中的速度都超过了一百万公里/秒。光速是宇宙中物质间的传播速度，其定义为光在真空中传播速度的平方除以光速的平方，也就是$c^2=m^2$。光速的绝对值是2997*2458米/秒，是物质在真空中的运动速度，约为每秒4.08米。光速的速度在不同情况下有不同的含义，比如在光源的光谱中，光的传播速度受到光的强度和波长的影响
，而在光谱中，光的传播速度受到光的强度、频率、光的亮度、波长等信息的影响。光速的速度在宏观物体中是恒定的，约为每秒299792458米。在物理学中，光速的速度是恒定的，但对于光源的光传播速度来说，它会被限制在微小范围内，甚
至无法传递。光速的速度是光源速度在真空中传播速度的最高点，而光源速度的限制则是指光源速度的大小，这种限制是由于光源的能量密度与光速之间的相对位置关系所导致的。



👶: 推荐一些杭州的特色美食吧。
🤖️: 杭州的特色美食有很多，其中比较有名的有：
1. 西湖醋鱼：又称“江苏的鱼”，是杭州传统名菜之一，有鲜美的汤和鲜美的鲤鱼。
2. 小龙虾：以小龙虾为代表的传统小吃，是杭州特有的小吃之一。
3. 杭州小笼包：以鲜嫩的肉馅、鲜香的汤和新鲜的蔬菜为主。
4. 龙井虾仁：以鲜虾为代表，有鲜美的海鲜风味，也是杭州非常有名的特色小吃之一。
5. 西塘：以古镇闻名，以新鲜的鱼为主料，搭配上鲜美的花生米和芋头等小吃，是杭州非常有名的小吃之一。
希望以上推荐能对您有所帮助。



👶: 请为我讲解“大语言模型”这个概念。
🤖️: 大语言模型是指一种基于神经网络的语言模型，主要用于自然语言处理任务。它可以进行文本摘要、机器翻译、对话系统等任务，能够处理大量的语言数据，并从中自动提取有意义的词汇、句法结构等信息，为文本生成和语音识别等领域提供支持。



👶: 如何理解ChatGPT？
🤖️: ChatGPT是一款由Google开发的自然语言处理工具，它旨在帮助用户创建有意义的对话，以理解自然语言。它使用语音识别技术，通过分析用户输入的语言，可以理解用户的输入，并使用语义分析技术，帮助用户回答各种问题。它也支持文
本生成，可以生成文本，让用户可以创建自己的回答，以理解用户的意图。



👶: Introduce the history of the United States, please.
🤖️: Introduce the history of the United States embers.
```

DPO 模型：

```
(base) root@C.26849627:~/minimind$ python eval_model.py --load 0 --model 2
MiniMind模型参数量: 104.03M(illion)
[0] 自动测试
[1] 手动输入
0
👶: 请介绍一下自己。
🤖️: 你好！我是一名AI语言模型，可以进行自然语言对话、回答问题、生成文本等任务。我是由大量数据训练而成的语言模型，可以理解和生成自然语言。



👶: 你更擅长哪一个学科？
🤖️: 我更擅长数学和逻辑推理。虽然数学和逻辑推理是相对抽象的学科，但它们之间没有必然的联系。数学是用来描述和解决问题的工具，而逻辑推理则是用来推理和证明推理的过程。数学是基础学科，数学是逻辑学的基础学科。数学是一个研究数量和空间的概念。逻辑推理是数学中常见的分支，主要用于推理和证明推理的过程。数学家使用逻辑思维来推理和证明推理的过程。



👶: 鲁迅的《狂人日记》是如何批判封建礼教的？
🤖️: 鲁迅的《狂人日记》在批判封建礼教方面存在问题，主要是因为其语言风格和内容过于夸张和夸张，或者对社会现实不符合现实，使得社会对人性和社会关系的评价存在问题。

鲁迅的小说通常采用了一种幽默、讽刺和讽刺的手法，以一种非常幽默的方式揭示了封建社会的一些问题，同时也批判了封建礼教的束缚和规矩。

在批判封建礼教方面，鲁迅的小说通常采用了一种非常夸张和夸张的手法，以一种非常幽默的方式揭示了社会现实中的一些问题。这种手法使得作品看起来非常荒谬和空洞，同时也对当时的社会秩序和道德观念提出了批判。

鲁迅的小说通常采用了一种非常幽默、讽刺和讽刺的手法，以一种非常幽默的方式揭示了封建社会的一些问题。这种手法使得作品显得非常荒谬和空洞，同时也对当时的社会关系进行了批判，使得作品显得非常荒谬和空洞。

因此，在批判封建礼教方面，鲁迅的小说往往采用了一种幽默、讽刺和讽刺的手法，以一种非常幽默的方式揭示了社会问题。这种手法使得作品看起来非常荒谬和空洞，同时也对当时的社会秩序和道德观念提出了批判。



👶: 我咳嗽已经持续了两周，需要去医院检查吗？
🤖️: 首先需要确定咳嗽的具体情况。咳嗽是身体不适的表现，主要是由于身体不适，包括肺部感染、肺炎等。如果咳嗽持续了两周，建议去医院进行检查。医生可能会检查肺部，检查是否有炎症或炎症等。如果没有，医生可能会建议进行胸部X
光检查、血液检查等检查。如果需要，医生还可以进行血液检查、喉咙放射检查等。在检查过程中，需要注意避免过度用力，不要饮酒或食用刺激性食物，以及避免与其他人接触。如果咳嗽持续了两周，建议及时去医院就诊，以便及时了解和治疗病情。



👶: 详细的介绍光速的物理概念。
🤖️: 光速是指光在真空中的传播速度，其测量单位是光速（c）。在真空中，光的速度为299,792,458米/秒，约为每秒393,458米。

光速是物理学中的基本常数之一，它表示光速在任何时候都等于299,792,458米/秒。在相对论中，光速被定义为9.87924/966.71秒，而在其他科学领域，如天文学和航空航天学中，光速被定义为每秒393,458米。

总之，光速是一个非常重要的概念，因为它是物理学中的一个基本概念，它被广泛应用于科学和技术领域。



👶: 推荐一些杭州的特色美食吧。
🤖️: 杭州的特色美食有很多，这里给您推荐几个：1. 西湖醋鱼：这是一道口感细腻、酸甜可口的特色小吃，是杭州的特色菜。2. 东坡肉：这是杭州的传统名菜之一，肉质鲜嫩，口感香糯。3. 东坡馒头：这是一道传统的中式糕点，口感香脆，
馅料丰富。4. 手工饺子：这是一道以肉馅为主的饺子，馅料柔软，口感清爽。5. 东坡汤：这是一道传统的汤类菜品，汤汁浓郁，味道鲜美。6. 小笼包：这是一道小笼包，馅料香浓，口感Q弹。7. 手工包：这是一道传统的西湖小吃，馅料口感
丰富，口感鲜美。8. 石锅拌饭：这是一道以米饭为主的传统小吃，馅料丰富，口感鲜美。以上这些美食都十分有特色，您可以根据自己的口味选择尝试。



👶: 请为我讲解“大语言模型”这个概念。
🤖️: 大语言模型（Generative Area）是一种基于大规模数据集训练的神经网络模型，可以处理自然语言的各种任务，例如机器翻译、文本分类、情感分析、语音识别、文本生成等。该模型的原理是通过不断的迭代学习，不断地更新和优化模型
，使得模型能够逐渐理解输入的自然语言，进而生成更加准确和自然的文本。具体来说，Generative采用了基于循环神经网络（RNN）的模型，通过预训练的方式，将输入的自然语言序列与预训练的序列数据进行比较，从而得到更加准确和自然
的文本输出。Generative在语言生成方面表现出色，能够生成更加流畅、自然的文本。同时，Generative还能够通过不断的迭代学习和优化，逐渐提高自己的生成效果，从而更好地满足用户的需求。



👶: 如何理解ChatGPT？
🤖️: ChatGPT是一款基于人工智能技术的模型，它可以被用来完成自然语言处理任务，例如翻译、问答、生成和分类等。ChatGPT的准确度可以达到90%以上，这意味着它可以快速地理解用户提出的问题，并给出正确的答案。它还能够处理自然语
言中的各种复杂性，例如语法和语义。ChatGPT还可以处理文本生成和分类任务，例如文本摘要、问答和分类等。此外，它还可以处理文本的语音和图像处理任务，例如语音识别和文字转语音，以及情感分析任务，例如评论和舆情分析。总的来
说，ChatGPT是一种强大的自然语言处理工具，它可以有效地处理自然语言，并能够处理文本和语音数据。



👶: Introduce the history of the United States, please.
🤖️: Introduce the history of theUnitedStates, please.
```


### 训练 VLM

OpenAI CLIP + pretrained LLM -> pretrained VLM -> SFT


```
(base) root@C.26658211:~/minimind/scripts$ python train_tokenizer.py
[00:01:08] Pre-processing sequences       ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 0        /        0
[00:02:54] Tokenize words                 ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 28220806 / 28220806
[00:00:55] Count pairs                    ███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████░ 28216824 / 28220806

[00:01:49] Count pairs                    ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 28220806 / 28220806
[00:26:09] Compute merges                 ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 6141     /     6141
Tokenizer training completed and saved.
<|im_start|>system
你是一个优秀的聊天机器人，总是给我正确的回应！<|im_end|>
<|im_start|>user
你来自哪里？<|im_end|>
<|im_start|>assistant
我来自地球<|im_end|>

tokenizer实际词表长度： 6400
encoder长度： 46
decoder和原始文本是否一致： True
```

Pretrained VLM:

```
$ python eval_vlm.py --load 0 --model 0
VLM参数量：104.622 百万
[Image]: 彩虹瀑布-Rainbow-Falls.jpg
🤖️: 彩虹桥上的水珠



[Image]: 小狗美女海边-Dog-Woman-Sea.jpg
🤖️: 一个年轻人在海滩上用狗头装饰的。



[Image]: 舞蹈-dance.jpg
🤖️: 这个舞蹈女舞者在舞台上表演。



[Image]: 太空宇航员-Astronaut-Space.jpg
🤖️: 宇航员在太空中进行太空飞行



[Image]: 城市车水马龙-city-traffic.jpg
🤖️: 夜幕降临时,在城市中心的街道上。



[Image]: 熊猫草地-Panda-Grassland.jpg
🤖️: 动物园里，一只熊猫正在吃竹子。



[Image]: 自行车鲜花-Bicycle-Flowers.jpg
🤖️: 在旧自行车上用旧的自行车的轮胎和车轮,在自行车上添加花卉和装饰品。



[Image]: 椅子老人看书-Chair-Elderly-Reading.jpg
🤖️: 一位老年妇女在公园读书。
```


After SFT:

```
$ python eval_vlm.py --load 0 --model 1
VLM参数量：104.622 百万
[Image]: 彩虹瀑布-Rainbow-Falls.jpg
🤖️: 这幅图片描绘了一个巨大的、色彩斑斓的巨型瀑布，它位于一条高速公路旁边，从画面上可以看到一座巨大而雄伟的巨型瀑布。瀑布上方悬挂着一道巨大的彩虹旗，增添了视觉吸引力。瀑布周围环绕着美丽的景色，为这如画般的美景增添了一份美丽。



[Image]: 小狗美女海边-Dog-Woman-Sea.jpg
🤖️: 这幅图像描绘了一个女人坐在海滩上，她的狗在她旁边，而她的狗则坐在一块蓝色和白色相间的地毯上。



[Image]: 舞蹈-dance.jpg
🤖️: 图片描绘了一个女人在舞台上表演跳舞，她的舞步高高地飘扬在舞台上。舞台上摆放着多把椅子，其中一把位于画面左侧，另一把在右侧，还有一把位于右侧。
舞台上摆放着多张椅子，其中一张靠近左边，另一张在右边。舞台上还有一个时钟，可能是为了帮助表演者掌握时间。



[Image]: 太空宇航员-Astronaut-Space.jpg
🤖️: 图中是一个巨大的太空船，它看起来像是一艘巨大的商用飞机。这艘飞机位于画面中央，正飞越一座小山和一座谷仓。这架飞机看起来像是机库，里面装满了各种各样的东西。
在飞机的周围，有一些人可能正在观察这架大型商用飞机。其中一些似乎正在观察飞行员的动作，而其他人则可能是在欣赏飞机的细节或享受这个场景。



[Image]: 城市车水马龙-city-traffic.jpg
🤖️: 这幅图片描绘了一个繁忙的城市街道，车辆川流不息，有几辆车和一辆卡车在行驶。高大的建筑物和街灯照亮了这个地区，创造出一种充满活力和生机勃勃的气氛。
在街道上，可以看到各种各样的车辆，包括几辆汽车和一辆卡车。还有一些行人也出现了，他们可能正在进行日常活动或穿行于城市环境之中。
总体而言，这幅图像捕捉到了一个充满活力的城市环境，车辆、行人和交通信号灯共同创造出一种活跃的气氛。



[Image]: 熊猫草地-Panda-Grassland.jpg
🤖️: 该图像描绘了一个戴着眼镜的黑白熊猫，一只黑白相间的长毛熊猫坐在草地上。这只熊猫似乎正盯着相机看，它看起来好像在看相机的影像。这只熊猫似乎正躺在草地上休息，可能是为了躲避阳光或挡雨。



[Image]: 自行车鲜花-Bicycle-Flowers.jpg
🤖️: 该图片展示了一辆自行车停放在一栋建筑外，背景中可以看到一排花瓶和花束。自行车占据了画面相当大的一部分，从左到右延伸开去。在整个场景中，有三盆盆栽植物，其中一盆靠近左侧，另一盆位于右侧，第三盆则位于左侧。
除了自行车，还有两个人在场景中，一个站在右边，另一个靠近左边的图像。



[Image]: 椅子老人看书-Chair-Elderly-Reading.jpg
🤖️: 该图像描绘了一个戴着眼镜的老年男子坐在公园的长椅上。他似乎在阅读一本书，可能是在享受户外环境。附近停着几辆车，其中一辆车位于图像的中心位置，另一辆车则位于右侧。背景中还有一个长凳，就在坐在长椅上的人旁边。
```
